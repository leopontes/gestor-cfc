<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="layout">

<body>
	<div class="container big"  layout:fragment="content">
  		<h4 th:text="#{label.titulo.aluno.agendamento}"></h4>
   		<div class="content">
   			<form method="post" th:action="@{/escala}" th:object="${filtro}">
   				<input type="hidden" th:field="*{inicio}"/>
   				<input type="hidden" th:field="*{fim}"/>
   				<input type="hidden" th:field="*{navigation}">
   				<div class="form-row">
					<div class="form-cel-100" style="margin-left: 5%;">
						<label class="components-form">Matricula:</label> 
						<input type="text" th:field="*{matricula}" class="components-form" style="width: 10%;" /> 
						<label class="components-form">Nome:</label> 
						<input type="text"  th:field="*{nome}" class="components-form" style="width: 30%;" />						
					</div>
				</div>
				<div class="form-row">
					<div class="form-cel-100" style="margin-left: 5%;">
						<label class="components-form">Veiculos:</label> 
						<select  th:field="*{veiculo}">
							<option value="0">Selecione</option>
							<option th:each="veiculo : ${veiculos}" th:value=${veiculo.id} th:text="${veiculo}"></option>
						</select> 
						<label class="components-form">Mes/Ano</label>
						<input type="text"  th:field="*{mesAno}"/>
						<button id="findUsuario">Buscar</button>
					</div>
   				</div>
			</form>
			<div class="form-row" th:if="${keys != null && !keys.empty}">
				<div class="form-cel-100">
					<nav class="navigation">
						<a id="previous" href="#" th:text="label.anterior"></a>|
						<a id="next" href="#" th:text="label.proximo"></a>
					</nav>
					<table id="tb-grade" style="width: 90%; margin-left: 5%; margin-bottom: 20px;">
						<thead>
							<tr style="background-color: #4f4f4f; ">
								<th style="color:#fff"></th>
								<th th:each="data : ${periodo}" th:text="${data}" style="text-align: center;color:#fff"></th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="horario : ${keys}">
								<td th:text="${horario}"></td>
								<td th:each="agendamento : ${grade.get(horario)}" th:class="${agendamento.processo != null ? 'agendado' : 'disponivel'}" style="text-align: center">
									<span th:if="${agendamento.processo != null}" th:text="${agendamento.processo.aluno.matricula}"></span>
									
									<a th:if="${agendamento.id != null && agendamento.processo.aluno.id == filtro.matricula}" 
									   th:text="#{label.desmarcar}" 
									   th:href="@{/escala/desmarcar(agendamentoId=${agendamento.id}, mesAno=${filtro.mesAno})}" class="agendamento-link" ></a>
									
									<a th:if="${agendamento.processo == null}" 
									   th:text="#{label.agendar}" 
									   th:href="@{/escala/agendar(aluno=${aluno.id}, data=${agendamento.data}, veiculo=${agendamento.veiculo.id}, mesAno=${filtro.mesAno})}" class="agendamento-link" ></a>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
   		</div>
	</div>	   		
</body>
</html>